<!DOCTYPE html>

<html>
<head>
<script>
function envoyer() {
    //Récupération des valeurs saisies pas l'utilisateur
    var rue = document.getElementById('rue').value;
    var ville = document.getElementById('code').value;
    
    //API issu de https://adresse.data.gouv.fr/api-doc/adresse
    
    //Création de l'object Ajax
    var req = new XMLHttpRequest();
    //Préparation de requette
    req.open("GET", "https://api-adresse.data.gouv.fr/search/?q=" + rue + "&postcode=" + ville, true); 
    //Définition du rappel pour traiter la réponse
    req.onreadystatechange = function() {
        if (req.readyState == 4 && req.status == 200) {
            var geocodeObjet = JSON.parse(req.responseText);
            //Filtre pour récupérer uniquement les valeurs GPS de l'adresse
            var long = geocodeObjet.features[0].geometry.coordinates[0];
            var lat = geocodeObjet.features[0].geometry.coordinates[1];
    
            var requete_pour_carte_php = new XMLHttpRequest();
            var url = "/lacarte.php?longitude=" + long + "&latitude=" + lat;
            requete_pour_carte_php.open("GET", url, true);
            //Définition du rappel pour traiter la réponse
            requete_pour_carte_php.onreadystatechange = function() {
                if (requete_pour_carte_php.readyState == 4 && requete_pour_carte_php.status == 200) {
                    var resultat = requete_pour_carte_php.responseText;
                    document.getElementById("result").innerHTML = resultat;
                }
            };
            requete_pour_carte_php.send(null);
        }
    };
    //Envoi de l'information au serveur
    req.send(null);
}   
</script>

</head>    

<body>
<p>Adresse <input id="rue"/></p>
<p>Code postal <input id="code"/></p>
<button onclick="envoyer()">Envoyer</button>
<p id="result"></p>

</body>
</html>